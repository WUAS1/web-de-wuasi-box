<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edición de Producto - Wuasi Box</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- CSS Personalizado -->
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .product-header {
            background: linear-gradient(135deg, #1a5f7a, #2a9d8f);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .product-code-display {
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            display: inline-block;
        }
        
        .history-card {
            border-left: 4px solid #e9c46a;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 0 8px 8px 0;
        }
        
        .history-item {
            padding: 8px 0;
            border-bottom: 1px solid #dee2e6;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .stock-change {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .stock-increase {
            background: rgba(42, 157, 143, 0.1);
            color: #2a9d8f;
        }
        
        .stock-decrease {
            background: rgba(230, 57, 70, 0.1);
            color: #e63946;
        }
        
        .price-change {
            font-weight: 600;
        }
        
        .price-increase {
            color: #2a9d8f;
        }
        
        .price-decrease {
            color: #e63946;
        }
        
        .audit-info {
            font-size: 0.85rem;
            color: #6c757d;
        }
        
        .tab-content {
            padding: 20px 0;
        }
        
        .nav-tabs-custom .nav-link {
            color: #495057;
            font-weight: 500;
            border: none;
            padding: 12px 25px;
            border-radius: 8px 8px 0 0;
            margin-right: 5px;
        }
        
        .nav-tabs-custom .nav-link.active {
            background: white;
            color: #1a5f7a;
            border-bottom: 3px solid #1a5f7a;
        }
        
        .nav-tabs-custom .nav-link:hover {
            color: #1a5f7a;
            background: rgba(26, 95, 122, 0.05);
        }
        
        .edit-actions {
            position: sticky;
            bottom: 0;
            background: white;
            padding: 15px;
            border-top: 1px solid #dee2e6;
            margin-top: 30px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .compare-view {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .compare-column {
            flex: 1;
            padding: 15px;
            border-radius: 8px;
        }
        
        .old-value {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
        }
        
        .new-value {
            background: rgba(26, 95, 122, 0.05);
            border: 1px solid rgba(26, 95, 122, 0.2);
        }
        
        .compare-label {
            font-weight: 600;
            margin-bottom: 10px;
            color: #495057;
        }
        
        .compare-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .compare-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        @media (max-width: 768px) {
            .compare-view {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Encabezado Corporativo -->
    <header class="corporate-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <div class="logo-container">
                        <div class="logo-icon" style="background: white; color: #e74c3c;">
                            <i class="fas fa-box-open"></i>
                        </div>
                        <div>
                            <h1 class="company-name mb-1">WUASI BOX</h1>
                            <p class="company-tagline mb-0">Edición de Productos</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 text-md-end">
                    <div class="text-white">
                        <p class="mb-1"><i class="fas fa-calendar-alt me-2"></i>Fecha: <span id="current-date"></span></p>
                        <p class="mb-0"><i class="fas fa-user me-2"></i>Usuario: <strong>Editor</strong></p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Navegación Principal -->
    <nav class="navbar navbar-expand-lg navbar-light main-nav">
        <div class="container">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarMain">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link nav-link-custom" href="index.html">
                            <i class="fas fa-home me-1"></i> Inicio
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-custom" href="registro.html">
                            <i class="fas fa-plus-circle me-1"></i> Nuevo Producto
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-custom" href="listado.html">
                            <i class="fas fa-list me-1"></i> Listado
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-custom active" href="edicion.html">
                            <i class="fas fa-edit me-1"></i> Edición
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-custom" href="busqueda.html">
                            <i class="fas fa-search me-1"></i> Búsqueda
                        </a>
                    </li>
                </ul>
                <div class="d-flex">
                    <button class="btn btn-boxpro btn-boxpro-primary me-2" onclick="window.history.back()">
                        <i class="fas fa-arrow-left me-1"></i> Volver
                    </button>
                    <button class="btn btn-boxpro btn-boxpro-success" onclick="saveChanges()">
                        <i class="fas fa-save me-1"></i> Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Contenido Principal -->
    <div class="container">
        <div class="main-container fade-in">
            <!-- Encabezado del Producto -->
            <div class="product-header">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h3 class="mb-2" id="productTitle">Cinta Transparente 48mm x 50m</h3>
                        <div class="product-code-display" id="productCode">WBS-100-0001</div>
                        <p class="mb-0 mt-2" id="productCategory">Categoría: Cintas Transparentes</p>
                    </div>
                    <div class="col-md-4 text-md-end">
                        <div class="mb-2">
                            <span class="badge bg-light text-dark me-2">
                                <i class="fas fa-box me-1"></i> Stock: <strong id="currentStock">150</strong>
                            </span>
                            <span class="badge bg-light text-dark">
                                <i class="fas fa-dollar-sign me-1"></i> Precio: <strong id="currentPrice">$4.99</strong>
                            </span>
                        </div>
                        <p class="mb-0 text-white-50" id="lastUpdate">
                            <small><i class="fas fa-history me-1"></i> Última modificación: 15/03/2024</small>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Pestañas de Edición -->
            <ul class="nav nav-tabs nav-tabs-custom" id="editTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="basic-tab" data-bs-toggle="tab" 
                            data-bs-target="#basic-tab-pane" type="button">
                        <i class="fas fa-info-circle me-2"></i>Información Básica
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="price-tab" data-bs-toggle="tab" 
                            data-bs-target="#price-tab-pane" type="button">
                        <i class="fas fa-dollar-sign me-2"></i>Precios y Stock
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="supplier-tab" data-bs-toggle="tab" 
                            data-bs-target="#supplier-tab-pane" type="button">
                        <i class="fas fa-truck me-2"></i>Proveedor y Ubicación
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="history-tab" data-bs-toggle="tab" 
                            data-bs-target="#history-tab-pane" type="button">
                        <i class="fas fa-history me-2"></i>Historial de Cambios
                    </button>
                </li>
            </ul>

            <div class="tab-content" id="editTabsContent">
                <!-- Pestaña 1: Información Básica -->
                <div class="tab-pane fade show active" id="basic-tab-pane" role="tabpanel">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="form-section">
                                <h5><i class="fas fa-edit me-2"></i>Editar Información Básica</h5>
                                
                                <div class="row g-3">
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Nombre del Producto</label>
                                        <input type="text" class="form-control form-control-custom" 
                                               id="editProductName" 
                                               value="Cinta Transparente 48mm x 50m">
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Categoría</label>
                                        <select class="form-select form-control-custom" id="editProductCategory">
                                            <option value="Cintas Transparentes" selected>Cintas Transparentes</option>
                                            <option value="Envoplast">Envoplast</option>
                                            <option value="Cinta Aislante">Cinta Aislante</option>
                                            <option value="Cinta de Oficina">Cinta de Oficina</option>
                                            <option value="Tirro de Papel">Tirro de Papel</option>
                                            <option value="Flejes Plásticos">Flejes Plásticos</option>
                                            <option value="Películas Estirables">Películas Estirables</option>
                                            <option value="Material de Protección">Material de Protección</option>
                                            <option value="Otros">Otros</option>
                                        </select>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Marca/Fabricante</label>
                                        <input type="text" class="form-control form-control-custom" 
                                               id="editProductBrand"
                                               value="3M">
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Descripción</label>
                                        <textarea class="form-control form-control-custom" 
                                                  id="editProductDescription" 
                                                  rows="4">Cinta adhesiva transparente para embalaje general, alta resistencia y excelente adhesión. Ideal para cierre de cajas y paquetes. Producto de primera calidad, adhesivo permanente.</textarea>
                                    </div>
                                    
                                    <div class="col-md-4">
                                        <label class="form-label-custom">Unidad de Medida</label>
                                        <select class="form-select form-control-custom" id="editProductUnit">
                                            <option value="Rollos" selected>Rollos</option>
                                            <option value="Unidades">Unidades</option>
                                            <option value="Metros">Metros</option>
                                            <option value="Kilos">Kilos</option>
                                            <option value="Cajas">Cajas</option>
                                        </select>
                                    </div>
                                    
                                    <div class="col-md-4">
                                        <label class="form-label-custom">Ancho</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control form-control-custom" 
                                                   id="editProductWidth"
                                                   value="48">
                                            <span class="input-group-text">mm</span>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-4">
                                        <label class="form-label-custom">Largo</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control form-control-custom" 
                                                   id="editProductLength"
                                                   value="50">
                                            <span class="input-group-text">m</span>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Color</label>
                                        <input type="text" class="form-control form-control-custom" 
                                               id="editProductColor"
                                               value="Transparente">
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Material</label>
                                        <input type="text" class="form-control form-control-custom" 
                                               id="editProductMaterial"
                                               value="Polipropileno">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="history-card">
                                <h6><i class="fas fa-history me-2"></i>Últimos Cambios</h6>
                                <div class="history-item">
                                    <small class="text-muted">15/03/2024 10:30</small>
                                    <p class="mb-1">Precio actualizado de $4.50 a $4.99</p>
                                    <span class="price-change price-increase">+$0.49</span>
                                </div>
                                <div class="history-item">
                                    <small class="text-muted">10/03/2024 14:20</small>
                                    <p class="mb-1">Stock actualizado de 120 a 150 unidades</p>
                                    <span class="stock-change stock-increase">+30</span>
                                </div>
                                <div class="history-item">
                                    <small class="text-muted">05/03/2024 09:15</small>
                                    <p class="mb-1">Descripción modificada</p>
                                    <small class="audit-info">Modificado por: Admin</small>
                                </div>
                                <div class="history-item">
                                    <small class="text-muted">28/02/2024 16:45</small>
                                    <p class="mb-1">Ubicación cambiada a A-01-02</p>
                                    <small class="audit-info">Modificado por: Inventario</small>
                                </div>
                            </div>
                            
                            <div class="alert alert-info mt-4">
                                <i class="fas fa-info-circle me-2"></i>
                                <strong>Nota:</strong> Los cambios en esta sección no afectan el stock ni los precios.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pestaña 2: Precios y Stock -->
                <div class="tab-pane fade" id="price-tab-pane" role="tabpanel">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-section">
                                <h5><i class="fas fa-chart-line me-2"></i>Ajuste de Precios</h5>
                                
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Precio de Compra Actual</label>
                                        <div class="input-group">
                                            <span class="input-group-text">$</span>
                                            <input type="text" class="form-control form-control-custom" 
                                                   value="2.50" readonly
                                                   style="background-color: #f8f9fa;">
                                        </div>
                                        <small class="text-muted">Precio actual</small>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Nuevo Precio de Compra</label>
                                        <div class="input-group">
                                            <span class="input-group-text">$</span>
                                            <input type="number" class="form-control form-control-custom" 
                                                   id="newPurchasePrice"
                                                   min="0.01" step="0.01"
                                                   placeholder="0.00">
                                        </div>
                                        <small class="text-muted">Precio actualizado</small>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Precio de Venta Actual</label>
                                        <div class="input-group">
                                            <span class="input-group-text">$</span>
                                            <input type="text" class="form-control form-control-custom" 
                                                   value="4.99" readonly
                                                   style="background-color: #f8f9fa;">
                                        </div>
                                        <small class="text-muted">Precio actual</small>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Nuevo Precio de Venta</label>
                                        <div class="input-group">
                                            <span class="input-group-text">$</span>
                                            <input type="number" class="form-control form-control-custom" 
                                                   id="newSalePrice"
                                                   min="0.01" step="0.01"
                                                   placeholder="0.00">
                                        </div>
                                        <small class="text-muted">Precio actualizado</small>
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <div class="price-comparison mt-3">
                                            <p class="mb-1">Margen actual: <strong>99.6%</strong></p>
                                            <p class="mb-1">Nuevo margen: <strong id="newMargin">0%</strong></p>
                                            <div class="progress mt-2" style="height: 8px;">
                                                <div class="progress-bar bg-success" style="width: 99.6%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <div class="alert alert-warning mt-3">
                                            <i class="fas fa-exclamation-triangle me-2"></i>
                                            <strong>Importante:</strong> Cambios en los precios afectarán inmediatamente todas las ventas futuras.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-section">
                                <h5><i class="fas fa-boxes me-2"></i>Gestión de Stock</h5>
                                
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Stock Actual</label>
                                        <input type="text" class="form-control form-control-custom" 
                                               value="150" readonly
                                               style="background-color: #f8f9fa;">
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Stock Mínimo Actual</label>
                                        <input type="text" class="form-control form-control-custom" 
                                               value="20" readonly
                                               style="background-color: #f8f9fa;">
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Ajuste de Stock</label>
                                        <div class="input-group">
                                            <select class="form-select form-control-custom" id="stockAction">
                                                <option value="add">Agregar Stock</option>
                                                <option value="remove">Retirar Stock</option>
                                                <option value="set">Establecer Nuevo Valor</option>
                                            </select>
                                            <input type="number" class="form-control form-control-custom" 
                                                   id="stockAdjustment"
                                                   min="0"
                                                   placeholder="Cantidad">
                                            <span class="input-group-text">unidades</span>
                                        </div>
                                        <small class="text-muted">Stock resultante: <strong id="resultingStock">150</strong> unidades</small>
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Nuevo Stock Mínimo</label>
                                        <input type="number" class="form-control form-control-custom" 
                                               id="newMinStock"
                                               min="0"
                                               value="20">
                                        <small class="text-muted">Alerta se activará cuando el stock esté por debajo de este valor</small>
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Motivo del Ajuste</label>
                                        <select class="form-select form-control-custom" id="adjustmentReason">
                                            <option value="">Seleccione un motivo</option>
                                            <option value="compra">Compra a proveedor</option>
                                            <option value="venta">Venta a cliente</option>
                                            <option value="devolucion">Devolución de cliente</option>
                                            <option value="ajuste">Ajuste de inventario</option>
                                            <option value="daño">Producto dañado</option>
                                            <option value="caducado">Producto caducado</option>
                                            <option value="otro">Otro motivo</option>
                                        </select>
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Notas del Ajuste</label>
                                        <textarea class="form-control form-control-custom" 
                                                  id="adjustmentNotes" 
                                                  rows="2"
                                                  placeholder="Observaciones o comentarios sobre el ajuste..."></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pestaña 3: Proveedor y Ubicación -->
                <div class="tab-pane fade" id="supplier-tab-pane" role="tabpanel">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-section">
                                <h5><i class="fas fa-truck-loading me-2"></i>Información del Proveedor</h5>
                                
                                <div class="row g-3">
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Proveedor Actual</label>
                                        <input type="text" class="form-control form-control-custom" 
                                               id="currentSupplier"
                                               value="Distribuidora Central SA"
                                               readonly
                                               style="background-color: #f8f9fa;">
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Nuevo Proveedor</label>
                                        <input type="text" class="form-control form-control-custom" 
                                               id="newSupplier"
                                               placeholder="Ingrese nuevo proveedor">
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Contacto</label>
                                        <input type="text" class="form-control form-control-custom" 
                                               id="supplierContact"
                                               value="Juan Pérez - 555-1234">
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <label class="form-label-custom">Teléfono</label>
                                        <input type="tel" class="form-control form-control-custom" 
                                               id="supplierPhone"
                                               placeholder="(555) 123-4567">
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Email</label>
                                        <input type="email" class="form-control form-control-custom" 
                                               id="supplierEmail"
                                               placeholder="contacto@proveedor.com">
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Dirección</label>
                                        <textarea class="form-control form-control-custom" 
                                                  id="supplierAddress" 
                                                  rows="2"
                                                  placeholder="Dirección del proveedor..."></textarea>
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <div class="alert alert-info mt-3">
                                            <i class="fas fa-info-circle me-2"></i>
                                            <strong>Recordatorio:</strong> Cambiar el proveedor no afecta el precio de compra actual.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-section">
                                <h5><i class="fas fa-warehouse me-2"></i>Gestión de Ubicación</h5>
                                
                                <div class="row g-3">
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Ubicación Actual</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
                                            <input type="text" class="form-control form-control-custom" 
                                                   value="A-01-02" readonly
                                                   style="background-color: #f8f9fa;">
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <label class="form-label-custom">Nueva Ubicación</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
                                            <input type="text" class="form-control form-control-custom" 
                                                   id="newLocation"
                                                   placeholder="Ej: B-03-01">
                                        </div>
                                        <small class="text-muted">Formato: Pasillo-Estante-Nivel (A-01-02)</small>
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <div class="alert alert-warning mt-3">
                                            <h6><i class="fas fa-exclamation-triangle me-2"></i>Instrucciones de Ubicación</h6>
                                            <ul class="mb-0">
                                                <li>Pasillo: Letra (A, B, C, ...)</li>
                                                <li>Estante: Número (01, 02, 03, ...)</li>
                                                <li>Nivel: Número (01, 02, 03, ...)</li>
                                                <li>Ejemplo: B-03-01 = Pasillo B, Estante 3, Nivel 1</li>
                                            </ul>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-12">
                                        <h6 class="mt-4 mb-3">Ubicaciones Sugeridas Disponibles</h6>
                                        <div class="row">
                                            <div class="col-6">
                                                <button type="button" class="btn btn-outline-primary w-100 mb-2" onclick="setLocation('A-02-01')">A-02-01</button>
                                                <button type="button" class="btn btn-outline-primary w-100 mb-2" onclick="setLocation('A-02-02')">A-02-02</button>
                                                <button type="button" class="btn btn-outline-primary w-100" onclick="setLocation('A-02-03')">A-02-03</button>
                                            </div>
                                            <div class="col-6">
                                                <button type="button" class="btn btn-outline-primary w-100 mb-2" onclick="setLocation('B-01-01')">B-01-01</button>
                                                <button type="button" class="btn btn-outline-primary w-100 mb-2" onclick="setLocation('B-01-02')">B-01-02</button>
                                                <button type="button" class="btn btn-outline-primary w-100" onclick="setLocation('B-01-03')">B-01-03</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pestaña 4: Historial de Cambios -->
                <div class="tab-pane fade" id="history-tab-pane" role="tabpanel">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-section">
                                <h5><i class="fas fa-history me-2"></i>Historial Completo de Cambios</h5>
                                
                                <div class="table-responsive">
                                    <table class="table table-custom">
                                        <thead>
                                            <tr>
                                                <th>Fecha</th>
                                                <th>Usuario</th>
                                                <th>Campo Modificado</th>
                                                <th>Valor Anterior</th>
                                                <th>Nuevo Valor</th>
                                                <th>Motivo</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>15/03/2024 10:30</td>
                                                <td>Admin</td>
                                                <td>Precio de Venta</td>
                                                <td>$4.50</td>
                                                <td><span class="price-change price-increase">$4.99</span></td>
                                                <td>Ajuste por inflación</td>
                                            </tr>
                                            <tr>
                                                <td>10/03/2024 14:20</td>
                                                <td>Inventario</td>
                                                <td>Stock</td>
                                                <td>120</td>
                                                <td><span class="stock-change stock-increase">150</span></td>
                                                <td>Compra a proveedor</td>
                                            </tr>
                                            <tr>
                                                <td>05/03/2024 09:15</td>
                                                <td>Admin</td>
                                                <td>Descripción</td>
                                                <td>Cinta adhesiva transparente...</td>
                                                <td>Cinta adhesiva transparente para embalaje general...</td>
                                                <td>Mejora en descripción</td>
                                            </tr>
                                            <tr>
                                                <td>28/02/2024 16:45</td>
                                                <td>Inventario</td>
                                                <td>Ubicación</td>
                                                <td>A-01-01</td>
                                                <td>A-01-02</td>
                                                <td>Reorganización de almacén</td>
                                            </tr>
                                            <tr>
                                                <td>20/02/2024 11:30</td>
                                                <td>Admin</td>
                                                <td>Proveedor</td>
                                                <td>Embalajes SA</td>
                                                <td>Distribuidora Central SA</td>
                                                <td>Cambio de proveedor</td>
                                            </tr>
                                            <tr>
                                                <td>15/02/2024 08:45</td>
                                                <td>Inventario</td>
                                                <td>Stock Mínimo</td>
                                                <td>15</td>
                                                <td><span class="stock-change">20</span></td>
                                                <td>Ajuste de políticas</td>
                                            </tr>
                                            <tr>
                                                <td>10/02/2024 13:20</td>
                                                <td>Ventas</td>
                                                <td>Stock</td>
                                                <td>150</td>
                                                <td><span class="stock-change stock-decrease">120</span></td>
                                                <td>Venta a cliente mayorista</td>
                                            </tr>
                                            <tr>
                                                <td>05/02/2024 09:00</td>
                                                <td>Admin</td>
                                                <td>Precio de Compra</td>
                                                <td>$2.30</td>
                                                <td><span class="price-change price-increase">$2.50</span></td>
                                                <td>Aumento de proveedor</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <div class="alert alert-info mt-4">
                                    <i class="fas fa-database me-2"></i>
                                    <strong>Información:</strong> Este historial muestra todos los cambios realizados en el producto desde su registro. 
                                    Los cambios se registran automáticamente con fecha, usuario y motivo.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Panel de Comparación (solo visible cuando hay cambios) -->
            <div class="compare-view" id="compareView" style="display: none;">
                <div class="compare-column old-value">
                    <div class="compare-label">Valores Actuales</div>
                    <div id="oldValues"></div>
                </div>
                <div class="compare-column new-value">
                    <div class="compare-label">Nuevos Valores</div>
                    <div id="newValues"></div>
                </div>
            </div>

            <!-- Acciones de Edición -->
            <div class="edit-actions">
                <div class="row">
                    <div class="col-md-6">
                        <button type="button" class="btn btn-boxpro btn-boxpro-secondary" onclick="previewChanges()">
                            <i class="fas fa-eye me-2"></i> Vista Previa de Cambios
                        </button>
                    </div>
                    <div class="col-md-6 text-end">
                        <button type="button" class="btn btn-boxpro btn-boxpro-danger me-2" onclick="discardChanges()">
                            <i class="fas fa-times me-2"></i> Descartar Cambios
                        </button>
                        <button type="button" class="btn btn-boxpro btn-boxpro-success" onclick="saveChanges()">
                            <i class="fas fa-save me-2"></i> Guardar Cambios
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pie de Página Corporativo -->
    <footer class="footer-corporate">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5 class="text-white mb-4">WUASI BOX</h5>
                    <p class="text-white-50">
                        Sistema de gestión para productos de embalaje. 
                        Control total de inventario y precios.
                    </p>
                </div>
                <div class="col-md-4">
                    <h5 class="text-white mb-4">Módulo de Edición</h5>
                    <div class="footer-links">
                        <p><a href="registro.html"><i class="fas fa-chevron-right me-2"></i>Registro Nuevo</a></p>
                        <p><a href="listado.html"><i class="fas fa-chevron-right me-2"></i>Listado Completo</a></p>
                        <p><a href="busqueda.html"><i class="fas fa-chevron-right me-2"></i>Buscar Productos</a></p>
                    </div>
                </div>
                <div class="col-md-4">
                    <h5 class="text-white mb-4">Auditoría</h5>
                    <p class="text-white-50">
                        <i class="fas fa-user-shield me-2"></i>Usuario: Admin
                    </p>
                    <p class="text-white-50">
                        <i class="fas fa-clock me-2"></i>Sesión iniciada: 09:00 AM
                    </p>
                    <p class="text-white-50">
                        <i class="fas fa-history me-2"></i>Último guardado: 10:30 AM
                    </p>
                </div>
            </div>
            <div class="copyright">
                <p class="mb-0">© 2024 Wuasi Box. Todos los cambios quedan registrados en el historial del sistema.</p>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Scripts personalizados -->
    <script>
        // Datos originales del producto
        const originalData = {
            name: "Cinta Transparente 48mm x 50m",
            category: "Cintas Transparentes",
            brand: "3M",
            description: "Cinta adhesiva transparente para embalaje general, alta resistencia y excelente adhesión. Ideal para cierre de cajas y paquetes. Producto de primera calidad, adhesivo permanente.",
            unit: "Rollos",
            width: "48",
            length: "50",
            color: "Transparente",
            material: "Polipropileno",
            purchasePrice: 2.50,
            salePrice: 4.99,
            stock: 150,
            minStock: 20,
            supplier: "Distribuidora Central SA",
            supplierContact: "Juan Pérez - 555-1234",
            location: "A-01-02",
            code: "WBS-100-0001"
        };
        
        // Datos actuales (pueden ser modificados)
        let currentData = { ...originalData };
        
        // Actualizar fecha actual
        function actualizarFecha() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('current-date').textContent = 
                now.toLocaleDateString('es-ES', options);
        }
        
        // Calcular nuevo margen
        function calculateNewMargin() {
            const newPurchasePrice = parseFloat(document.getElementById('newPurchasePrice').value) || originalData.purchasePrice;
            const newSalePrice = parseFloat(document.getElementById('newSalePrice').value) || originalData.salePrice;
            
            if (newPurchasePrice > 0 && newSalePrice > 0) {
                const profit = newSalePrice - newPurchasePrice;
                const margin = (profit / newPurchasePrice) * 100;
                document.getElementById('newMargin').textContent = `${margin.toFixed(1)}%`;
            }
        }
        
        // Calcular stock resultante
        function calculateResultingStock() {
            const currentStock = originalData.stock;
            const adjustment = parseInt(document.getElementById('stockAdjustment').value) || 0;
            const action = document.getElementById('stockAction').value;
            
            let resultingStock = currentStock;
            
            switch(action) {
                case 'add':
                    resultingStock = currentStock + adjustment;
                    break;
                case 'remove':
                    resultingStock = currentStock - adjustment;
                    break;
                case 'set':
                    resultingStock = adjustment;
                    break;
            }
            
            document.getElementById('resultingStock').textContent = resultingStock;
            return resultingStock;
        }
        
        // Establecer ubicación sugerida
        function setLocation(location) {
            document.getElementById('newLocation').value = location;
        }
        
        // Vista previa de cambios
        function previewChanges() {
            // Recolectar datos modificados
            const modifiedData = {
                name: document.getElementById('editProductName').value,
                category: document.getElementById('editProductCategory').value,
                brand: document.getElementById('editProductBrand').value,
                description: document.getElementById('editProductDescription').value,
                unit: document.getElementById('editProductUnit').value,
                width: document.getElementById('editProductWidth').value,
                length: document.getElementById('editProductLength').value,
                color: document.getElementById('editProductColor').value,
                material: document.getElementById('editProductMaterial').value,
                purchasePrice: parseFloat(document.getElementById('newPurchasePrice').value) || originalData.purchasePrice,
                salePrice: parseFloat(document.getElementById('newSalePrice').value) || originalData.salePrice,
                stock: calculateResultingStock(),
                minStock: parseInt(document.getElementById('newMinStock').value) || originalData.minStock,
                supplier: document.getElementById('newSupplier').value || originalData.supplier,
                supplierContact: document.getElementById('supplierContact').value,
                location: document.getElementById('newLocation').value || originalData.location
            };
            
            // Generar HTML para comparación
            let oldValuesHTML = '';
            let newValuesHTML = '';
            
            const fields = [
                { label: 'Nombre', key: 'name' },
                { label: 'Categoría', key: 'category' },
                { label: 'Marca', key: 'brand' },
                { label: 'Unidad', key: 'unit' },
                { label: 'Precio Compra', key: 'purchasePrice', format: value => `$${value.toFixed(2)}` },
                { label: 'Precio Venta', key: 'salePrice', format: value => `$${value.toFixed(2)}` },
                { label: 'Stock', key: 'stock' },
                { label: 'Stock Mínimo', key: 'minStock' },
                { label: 'Proveedor', key: 'supplier' },
                { label: 'Ubicación', key: 'location' }
            ];
            
            fields.forEach(field => {
                const oldValue = field.format ? field.format(originalData[field.key]) : originalData[field.key];
                const newValue = field.format ? field.format(modifiedData[field.key]) : modifiedData[field.key];
                
                if (oldValue !== newValue) {
                    oldValuesHTML += `
                        <div class="compare-item">
                            <div><strong>${field.label}:</strong></div>
                            <div>${oldValue}</div>
                        </div>
                    `;
                    
                    newValuesHTML += `
                        <div class="compare-item">
                            <div><strong>${field.label}:</strong></div>
                            <div style="color: #1a5f7a; font-weight: 600;">${newValue}</div>
                        </div>
                    `;
                }
            });
            
            if (oldValuesHTML === '') {
                alert('No hay cambios para mostrar');
                return;
            }
            
            document.getElementById('oldValues').innerHTML = oldValuesHTML;
            document.getElementById('newValues').innerHTML = newValuesHTML;
            document.getElementById('compareView').style.display = 'flex';
            
            // Scroll a la vista de comparación
            document.getElementById('compareView').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Guardar cambios
        function saveChanges() {
            if (!confirm('¿Está seguro de guardar los cambios?\nEsta acción actualizará permanentemente el producto.')) {
                return;
            }
            
            // Recolectar datos
            currentData = {
                name: document.getElementById('editProductName').value,
                category: document.getElementById('editProductCategory').value,
                brand: document.getElementById('editProductBrand').value,
                description: document.getElementById('editProductDescription').value,
                unit: document.getElementById('editProductUnit').value,
                width: document.getElementById('editProductWidth').value,
                length: document.getElementById('editProductLength').value,
                color: document.getElementById('editProductColor').value,
                material: document.getElementById('editProductMaterial').value,
                purchasePrice: parseFloat(document.getElementById('newPurchasePrice').value) || originalData.purchasePrice,
                salePrice: parseFloat(document.getElementById('newSalePrice').value) || originalData.salePrice,
                stock: calculateResultingStock(),
                minStock: parseInt(document.getElementById('newMinStock').value) || originalData.minStock,
                supplier: document.getElementById('newSupplier').value || originalData.supplier,
                supplierContact: document.getElementById('supplierContact').value,
                location: document.getElementById('newLocation').value || originalData.location,
                code: originalData.code
            };
            
            // Simular guardado
            const saveBtn = document.querySelector('.btn-boxpro-success');
            const originalText = saveBtn.innerHTML;
            
            saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Guardando...';
            saveBtn.disabled = true;
            
            setTimeout(() => {
                // Actualizar interfaz
                document.getElementById('productTitle').textContent = currentData.name;
                document.getElementById('currentStock').textContent = currentData.stock;
                document.getElementById('currentPrice').textContent = `$${currentData.salePrice.toFixed(2)}`;
                document.getElementById('productCategory').textContent = `Categoría: ${currentData.category}`;
                
                // Actualizar fecha de última modificación
                const now = new Date();
                document.getElementById('lastUpdate').innerHTML = `
                    <small><i class="fas fa-history me-1"></i> Última modificación: ${now.toLocaleDateString()} ${now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</small>
                `;
                
                // Mostrar mensaje de éxito
                alert('¡Cambios guardados exitosamente!');
                
                // Restaurar botón
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
                
                // Ocultar vista de comparación
                document.getElementById('compareView').style.display = 'none';
                
                // Actualizar datos originales
                Object.assign(originalData, currentData);
                
            }, 1500);
        }
        
        // Descartar cambios
        function discardChanges() {
            if (!confirm('¿Está seguro de descartar todos los cambios?\nLos datos volverán a sus valores originales.')) {
                return;
            }
            
            // Restaurar valores originales
            document.getElementById('editProductName').value = originalData.name;
            document.getElementById('editProductCategory').value = originalData.category;
            document.getElementById('editProductBrand').value = originalData.brand;
            document.getElementById('editProductDescription').value = originalData.description;
            document.getElementById('editProductUnit').value = originalData.unit;
            document.getElementById('editProductWidth').value = originalData.width;
            document.getElementById('editProductLength').value = originalData.length;
            document.getElementById('editProductColor').value = originalData.color;
            document.getElementById('editProductMaterial').value = originalData.material;
            document.getElementById('newPurchasePrice').value = '';
            document.getElementById('newSalePrice').value = '';
            document.getElementById('stockAdjustment').value = '';
            document.getElementById('newMinStock').value = originalData.minStock;
            document.getElementById('newSupplier').value = '';
            document.getElementById('supplierContact').value = originalData.supplierContact;
            document.getElementById('newLocation').value = '';
            
            // Ocultar vista de comparación
            document.getElementById('compareView').style.display = 'none';
            
            alert('Cambios descartados. Los valores han sido restaurados.');
        }
        
        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            actualizarFecha();
            
            // Configurar event listeners
            document.getElementById('newPurchasePrice').addEventListener('input', calculateNewMargin);
            document.getElementById('newSalePrice').addEventListener('input', calculateNewMargin);
            document.getElementById('stockAdjustment').addEventListener('input', calculateResultingStock);
            document.getElementById('stockAction').addEventListener('change', calculateResultingStock);
            
            // Calcular valores iniciales
            calculateNewMargin();
            calculateResultingStock();
            
            // Simular carga
            setTimeout(() => {
                document.querySelector('.fade-in').style.opacity = '1';
            }, 100);
        });
    </script>
</body>
</html>